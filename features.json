{
  "features": [
    {
      "featureId": "feature-01",
      "name": "Database Schema Design",
      "description": "Design and implement the complete database schema for users, subscriptions (Basic/Premium/Bundle tiers), pregnancy profiles (due date, health preferences, symptoms, lifestyle factors), weekly guides, delivery history, and Q&A interactions. This is the foundation for all data persistence.",
      "agentAssigned": "schema-builder",
      "dependencies": [],
      "files": [
        "prisma/schema.prisma",
        "prisma/migrations/",
        "src/types/database.ts"
      ],
      "detailedPrompt": "Create a comprehensive database schema for the AI-powered pregnancy weekly guide service. Include tables/models for: 1) Users (email, password, name, created_at) 2) Subscriptions (user_id, tier [Basic $7.99-9.99, Premium $14.99-19.99, Bundle $99-149], status, stripe_customer_id, stripe_subscription_id, current_period_end) 3) PregnancyProfiles (user_id, due_date, current_week, health_preferences JSON, dietary_restrictions, exercise_level, symptoms JSON, concerns JSON) 4) WeeklyGuides (user_id, week_number, content JSON with sections: fetal_development, nutrition_tips, exercise_recommendations, symptom_explanations, preparation_advice, generated_at, delivered_at) 5) DeliveryLog (guide_id, channel [email/sms], status, sent_at) 6) QAInteractions (user_id, question, answer, created_at) for premium Q&A feature. Use appropriate indexes for queries by user_id, subscription status, and delivery scheduling.",
      "estimatedMinutes": 45
    },
    {
      "featureId": "feature-02",
      "name": "User Authentication and Authorization System",
      "description": "Implement secure user registration, login, JWT-based authentication, and role-based authorization (user/admin). Includes password hashing, token management, and protected route middleware.",
      "agentAssigned": "api-developer",
      "dependencies": ["feature-01"],
      "files": [
        "src/routes/auth.ts",
        "src/middleware/auth.ts",
        "src/controllers/authController.ts",
        "src/utils/jwt.ts"
      ],
      "detailedPrompt": "Build a complete authentication system with: 1) POST /api/auth/register endpoint (email, password, name validation) 2) POST /api/auth/login endpoint returning JWT tokens 3) POST /api/auth/refresh for token refresh 4) GET /api/auth/me for current user profile 5) JWT middleware to protect routes 6) Password hashing with bcrypt 7) Email validation and duplicate prevention 8) Role-based middleware (user vs admin) for future admin dashboard. Use secure practices: HttpOnly cookies for tokens, CORS configuration, rate limiting on auth endpoints.",
      "estimatedMinutes": 60
    },
    {
      "featureId": "feature-03",
      "name": "Stripe Subscription Integration",
      "description": "Integrate Stripe for handling subscription payments across three tiers: Basic ($7.99-9.99/month), Premium ($14.99-19.99/month), and one-time Bundle ($99-149). Includes webhook handling for subscription events.",
      "agentAssigned": "backend-logic",
      "dependencies": ["feature-01", "feature-02"],
      "files": [
        "src/services/stripe.ts",
        "src/routes/subscription.ts",
        "src/controllers/subscriptionController.ts",
        "src/webhooks/stripe.ts"
      ],
      "detailedPrompt": "Implement Stripe integration for subscription management: 1) Create Stripe products and prices for Basic (monthly $7.99-9.99), Premium (monthly $14.99-19.99), and Bundle (one-time $99-149) tiers 2) POST /api/subscription/create-checkout endpoint to create Stripe checkout sessions 3) POST /api/subscription/portal endpoint for customer portal access 4) POST /api/webhooks/stripe to handle webhook events (checkout.session.completed, customer.subscription.created, updated, deleted, invoice.paid, payment_failed) 5) Update subscription status in database based on webhook events 6) Store stripe_customer_id and stripe_subscription_id with user records 7) Implement subscription tier validation middleware to check user's active subscription level for feature gating (Basic vs Premium features).",
      "estimatedMinutes": 90
    },
    {
      "featureId": "feature-04",
      "name": "Pregnancy Profile and Preferences Management API",
      "description": "API endpoints for users to create and update their pregnancy profile including due date, health preferences, symptoms tracking, dietary restrictions, exercise level, and ongoing concerns. This data personalizes the AI-generated content.",
      "agentAssigned": "api-developer",
      "dependencies": ["feature-01", "feature-02"],
      "files": [
        "src/routes/profile.ts",
        "src/controllers/profileController.ts",
        "src/services/profileService.ts",
        "src/validators/profileValidator.ts"
      ],
      "detailedPrompt": "Create pregnancy profile management endpoints: 1) POST /api/profile endpoint to create initial profile with due_date (required), health_preferences (vegetarian, vegan, allergies, etc.), dietary_restrictions, exercise_level (sedentary, light, moderate, active), initial_symptoms array, concerns array 2) GET /api/profile to retrieve user's current profile including calculated current_week based on due_date 3) PATCH /api/profile to update preferences, symptoms, concerns as they change throughout pregnancy 4) Implement automatic pregnancy week calculation from due date (40 weeks pregnancy cycle) 5) Validation for due_date (must be future, reasonable range), enum validation for exercise_level 6) Structure JSON fields for flexible symptom and concern tracking that AI will use for personalization.",
      "estimatedMinutes": 50
    },
    {
      "featureId": "feature-05",
      "name": "AI Content Generation Service",
      "description": "Core AI service that generates personalized weekly pregnancy guides using GPT-4/Claude. Takes user's pregnancy week, health preferences, symptoms, and lifestyle factors to create customized content covering fetal development, nutrition, exercise, symptom explanations, and preparation advice.",
      "agentAssigned": "backend-logic",
      "dependencies": ["feature-01", "feature-04"],
      "files": [
        "src/services/aiContentGenerator.ts",
        "src/prompts/weeklyGuidePrompt.ts",
        "src/types/weeklyGuide.ts",
        "src/config/openai.ts"
      ],
      "detailedPrompt": "Build the AI content generation service that creates personalized weekly guides: 1) Service function generateWeeklyGuide(userId, weekNumber) that fetches user's PregnancyProfile and generates customized content 2) Integrate OpenAI GPT-4 or Anthropic Claude API 3) Craft detailed prompt template that includes: week-specific fetal development facts, personalized nutrition tips based on dietary_restrictions and preferences, exercise recommendations tailored to exercise_level and current symptoms, explanations for user's reported symptoms, preparation/planning advice for upcoming weeks 4) Structure AI output as JSON with sections: fetal_development (string), nutrition_tips (array), exercise_recommendations (array), symptom_explanations (object mapping symptoms to explanations), preparation_advice (array) 5) Implement content validation and fallback handling 6) Store generated guide in WeeklyGuides table 7) Handle API errors gracefully with retry logic 8) Optimize prompt for cost efficiency while maintaining quality personalization.",
      "estimatedMinutes": 75
    },
    {
      "featureId": "feature-06",
      "name": "Email Delivery Service Integration",
      "description": "Integration with email service provider (SendGrid/Mailgun/AWS SES) to deliver weekly personalized pregnancy guides to all users (Basic and Premium tiers). Includes email templating with HTML formatting for guide content.",
      "agentAssigned": "integration-specialist",
      "dependencies": ["feature-01", "feature-05"],
      "files": [
        "src/services/emailService.ts",
        "src/templates/weeklyGuideEmail.ts",
        "src/config/email.ts"
      ],
      "detailedPrompt": "Implement email delivery service for weekly guides: 1) Integrate with SendGrid, Mailgun, or AWS SES (configurable via environment variables) 2) Create sendWeeklyGuide(userId, guideId) function that retrieves guide content and user email 3) Design responsive HTML email template that beautifully formats the weekly guide sections (fetal development, nutrition, exercise, symptoms, preparation) with proper typography and mobile optimization 4) Include personalization tokens (user name, week number, due date countdown) 5) Add unsubscribe link and subscription management footer 6) Log delivery in DeliveryLog table with status tracking 7) Handle delivery failures with retry queue 8) Implement email validation before sending 9) Support both transactional emails (weekly guides) and onboarding/welcome emails 10) Make emails engaging with week-specific subject lines like 'Your Week [X] Pregnancy Guide: [Milestone]'.",
      "estimatedMinutes": 60
    },
    {
      "featureId": "feature-07",
      "name": "SMS Delivery Service Integration (Premium Feature)",
      "description": "Integration with SMS service provider (Twilio) to deliver weekly guide summaries via SMS to Premium tier subscribers. This is a key differentiator for the Premium subscription tier.",
      "agentAssigned": "integration-specialist",
      "dependencies": ["feature-01", "feature-03", "feature-05"],
      "files": [
        "src/services/smsService.ts",
        "src/templates/weeklyGuideSMS.ts",
        "src/config/twilio.ts"
      ],
      "detailedPrompt": "Implement SMS delivery for Premium subscribers: 1) Integrate Twilio API for SMS sending 2) Create sendWeeklyGuideSMS(userId, guideId) function that checks user has Premium subscription before sending 3) Store phone_number in User table with validation (format, opt-in consent) 4) Generate concise SMS-friendly summary of weekly guide (160-320 characters) highlighting key milestone and 2-3 tips, with link to full guide in web dashboard 5) Log SMS delivery in DeliveryLog table 6) Implement subscription tier check to ensure only Premium users receive SMS 7) Handle opt-out/STOP commands per SMS regulations 8) Track SMS delivery status and failed sends 9) Make SMS messages friendly and encouraging, e.g., 'Week [X]: Baby is size of a [fruit]! 3 tips: [tip1], [tip2], [tip3]. View full guide: [link]'.",
      "estimatedMinutes": 55
    },
    {
      "featureId": "feature-08",
      "name": "Automated Weekly Guide Scheduler",
      "description": "Cron job/scheduled task system that automatically generates and delivers weekly pregnancy guides to all active subscribers. Runs daily to check which users need their weekly guide based on their pregnancy week progression.",
      "agentAssigned": "backend-logic",
      "dependencies": ["feature-01", "feature-03", "feature-05", "feature-06", "feature-07"],
      "files": [
        "src/jobs/weeklyGuideScheduler.ts",
        "src/services/schedulerService.ts",
        "src/config/scheduler.ts"
      ],
      "detailedPrompt": "Build automated scheduler for weekly guide delivery: 1) Implement daily cron job (runs at 6 AM user local time or configurable time) using node-cron or agenda.js 2) Query all active subscribers (subscription status = active or trialing) 3) Calculate current pregnancy week from due_date for each user 4) Check if user needs weekly guide (hasn't received guide for current week yet) 5) For each eligible user: a) Call AI content generation service to generate personalized guide, b) Store guide in database, c) Send via email (all tiers), d) Send via SMS if Premium tier 6) Implement batch processing with rate limiting to handle large subscriber bases without overwhelming AI API or email service 7) Add error handling and retry logic for failed generations/deliveries 8) Log all scheduler runs with success/failure counts 9) Support manual trigger endpoint POST /api/admin/trigger-weekly-guides for testing 10) Handle timezone considerations for global users 11) Skip users who have already delivered (due date passed).",
      "estimatedMinutes": 70
    },
    {
      "featureId": "feature-09",
      "name": "Interactive Q&A Chatbot API (Premium Feature)",
      "description": "AI-powered chatbot endpoint that allows Premium subscribers to ask pregnancy-related questions and receive personalized answers. This is a key Premium feature differentiator providing on-demand support beyond weekly guides.",
      "agentAssigned": "backend-logic",
      "dependencies": ["feature-01", "feature-02", "feature-03", "feature-04"],
      "files": [
        "src/routes/qa.ts",
        "src/controllers/qaController.ts",
        "src/services/qaChatbot.ts",
        "src/prompts/qaPrompt.ts"
      ],
      "detailedPrompt": "Implement interactive Q&A chatbot for Premium users: 1) POST /api/qa/ask endpoint that accepts question text and checks user has Premium subscription 2) Integrate with OpenAI GPT-4 or Claude API for conversational responses 3) Build context-aware prompts that include user's current pregnancy week, symptoms, health preferences for personalized answers 4) System prompt that establishes chatbot as helpful pregnancy guide (not medical advice, recommends consulting healthcare provider for medical concerns) 5) Store all Q&A interactions in QAInteractions table for history and potential content mining 6) GET /api/qa/history endpoint to retrieve user's past questions and answers 7) Implement rate limiting (e.g., 20 questions per month for Premium to manage API costs) 8) Add content moderation to filter inappropriate questions 9) Return answers in structured format with sources/disclaimers 10) Track usage metrics per user for business analytics.",
      "estimatedMinutes": 65
    },
    {
      "featureId": "feature-10",
      "name": "Landing Page and Pricing Page",
      "description": "Marketing landing page showcasing the service value proposition, features comparison between Basic and Premium tiers, testimonials, and pricing information. This is the entry point for new users to understand and subscribe.",
      "agentAssigned": "frontend-developer",
      "dependencies": [],
      "files": [
        "src/pages/index.tsx",
        "src/pages/pricing.tsx",
        "src/components/Hero.tsx",
        "src/components/Features.tsx",
        "src/components/PricingCards.tsx",
        "src/components/Testimonials.tsx"
      ],
      "detailedPrompt": "Create compelling landing and pricing pages: 1) Landing page (/) with: hero section emphasizing personalized AI-powered pregnancy guidance vs generic free newsletters, key benefits (weekly personalized guides, nutrition/exercise tailored to you, symptom explanations, 90% automated), feature showcase, social proof/testimonials, CTA buttons to signup 2) Pricing page (/pricing) with: three pricing tiers displayed as cards (Basic $7.99-9.99/month: email weekly guides + basic personalization; Premium $14.99-19.99/month: everything in Basic + SMS delivery + advanced personalization + interactive Q&A; Bundle $99-149 one-time: complete 9-month journey prepaid), feature comparison table, FAQ section addressing common questions, trust badges (secure payment, privacy), CTA buttons linking to Stripe checkout 3) Responsive design optimized for mobile 4) Fast loading with optimized images 5) SEO metadata for pregnancy-related keywords 6) Track conversion events (page views, CTA clicks).",
      "estimatedMinutes": 80
    },
    {
      "featureId": "feature-11",
      "name": "User Onboarding Flow",
      "description": "Multi-step onboarding process after signup that collects due date, health preferences, dietary restrictions, exercise level, initial symptoms, and concerns. This critical flow gathers data needed for AI personalization.",
      "agentAssigned": "frontend-developer",
      "dependencies": ["feature-02", "feature-04"],
      "files": [
        "src/pages/onboarding.tsx",
        "src/components/onboarding/DueDateStep.tsx",
        "src/components/onboarding/HealthPreferencesStep.tsx",
        "src/components/onboarding/SymptomsStep.tsx",
        "src/components/onboarding/LifestyleStep.tsx",
        "src/components/onboarding/ReviewStep.tsx"
      ],
      "detailedPrompt": "Build guided onboarding flow after user signup: 1) Multi-step wizard with progress indicator (5 steps) 2) Step 1: Due date selection with date picker (validate future date, reasonable range within 10 months) and pregnancy week calculation preview 3) Step 2: Health preferences checkboxes (vegetarian, vegan, pescatarian, gluten-free, dairy-free, nut allergies, other allergies text input) 4) Step 3: Dietary restrictions and preferences (food aversions, cravings, supplements currently taking) 5) Step 4: Lifestyle factors (exercise level dropdown: sedentary/light/moderate/active, work type: desk/active/standing, sleep quality) 6) Step 5: Current symptoms multi-select (nausea, fatigue, back pain, heartburn, swelling, mood changes, etc.) and concerns (free text area for specific worries or questions) 7) Review step showing summary with edit capability 8) Submit all data via POST /api/profile 9) Redirect to dashboard on completion 10) Save progress in localStorage to handle incomplete sessions 11) Welcoming copy explaining how this data personalizes their guides 12) Skip option for users who want to complete later.",
      "estimatedMinutes": 90
    },
    {
      "featureId": "feature-12",
      "name": "User Dashboard",
      "description": "Main user interface where subscribers view their weekly guides archive, update pregnancy profile/preferences, track symptoms, access Q&A chatbot (Premium), and manage subscription. This is the primary logged-in user experience.",
      "agentAssigned": "frontend-developer",
      "dependencies": ["feature-02", "feature-04", "feature-05", "feature-09"],
      "files": [
        "src/pages/dashboard.tsx",
        "src/components/dashboard/WeeklyGuidesArchive.tsx",
        "src/components/dashboard/ProfileEditor.tsx",
        "src/components/dashboard/SymptomTracker.tsx",
        "src/components/dashboard/QAChatbot.tsx",
        "src/components/dashboard/SubscriptionCard.tsx",
        "src/components/dashboard/ProgressTracker.tsx"
      ],
      "detailedPrompt": "Create comprehensive user dashboard: 1) Overview section showing current pregnancy week, days until due date, visual pregnancy progress bar (0-40 weeks) 2) Latest weekly guide display with formatted sections (fetal development, nutrition tips, exercise, symptoms, preparation advice) with print/save PDF options 3) Weekly guides archive with filterable list of all past guides by week number 4) Profile editor to update health preferences, symptoms, concerns, dietary restrictions, exercise level (calls PATCH /api/profile) 5) Symptom tracker allowing users to log symptoms over time with date stamps (helps AI personalization) 6) Q&A chatbot interface (Premium only - show upgrade prompt for Basic users) with chat history and new question input 7) Subscription management card showing current tier, renewal date, option to upgrade/downgrade, link to Stripe customer portal 8) Settings section for email/SMS preferences, notification settings, phone number for SMS (Premium) 9) Mobile-responsive design 10) Loading states and error handling 11) Empty states for new users without guides yet.",
      "estimatedMinutes": 100
    },
    {
      "featureId": "feature-13",
      "name": "Admin Dashboard",
      "description": "Administrative interface for monitoring subscriber metrics, revenue, content delivery status, user engagement, and manual intervention capabilities. Essential for solo developer to maintain and grow the business efficiently.",
      "agentAssigned": "frontend-developer",
      "dependencies": ["feature-02", "feature-03"],
      "files": [
        "src/pages/admin/dashboard.tsx",
        "src/pages/admin/users.tsx",
        "src/pages/admin/analytics.tsx",
        "src/routes/admin.ts",
        "src/controllers/adminController.ts",
        "src/middleware/adminAuth.ts"
      ],
      "detailedPrompt": "Build admin dashboard with key metrics and controls: 1) Overview page with KPIs: total active subscribers (by tier), MRR (Monthly Recurring Revenue), ARR projection, churn rate, new signups this week/month, average subscription duration, LTV (Lifetime Value) 2) Subscriber list page with search, filters by tier/status, view individual user profiles, see their delivery history, manually trigger guide generation/delivery for specific user 3) Analytics page with charts: subscription growth over time, revenue trends, tier distribution (Basic vs Premium vs Bundle), content delivery success rates (email/SMS), Q&A usage metrics (Premium feature engagement), common symptoms tracked across users (anonymized insights) 4) Manual controls: trigger weekly scheduler manually, view failed deliveries and retry, pause/resume individual subscriptions 5) Admin API endpoints: GET /api/admin/metrics, GET /api/admin/users with pagination, POST /api/admin/users/:id/trigger-guide 6) Role-based access with admin authentication middleware 7) Export capabilities for subscriber data, revenue reports 8) Alert notifications for critical issues (high delivery failure rate, payment failures) 9) Simple, functional design focused on efficiency over aesthetics.",
      "estimatedMinutes": 95
    },
    {
      "featureId": "feature-14",
      "name": "API Unit and Integration Tests",
      "description": "Comprehensive test suite for all API endpoints, services, and integrations to ensure reliability and catch bugs before deployment. Critical for maintaining quality in automated business.",
      "agentAssigned": "unit-tester",
      "dependencies": ["feature-02", "feature-03", "feature-04", "feature-05", "feature-06", "feature-07", "feature-08", "feature-09"],
      "files": [
        "tests/auth.test.ts",
        "tests/profile.test.ts",
        "tests/subscription.test.ts",
        "tests/aiContentGenerator.test.ts",
        "tests/emailService.test.ts",
        "tests/smsService.test.ts",
        "tests/scheduler.test.ts",
        "tests/qa.test.ts",
        "tests/setup.ts"
      ],
      "detailedPrompt": "Create comprehensive test suite: 1) Authentication tests: register with valid/invalid data, login success/failure, JWT token validation, protected route access 2) Profile tests: create profile with required fields, update preferences, calculate pregnancy week correctly, validation errors 3) Subscription tests: Stripe checkout creation, webhook handling for all subscription events, tier validation middleware, subscription status updates 4) AI content generation tests: mock OpenAI/Claude API, verify personalization includes user's symptoms and preferences, handle API errors gracefully, validate output structure 5) Email service tests: mock SendGrid/Mailgun, verify email sending with correct template, handle delivery failures, log delivery status 6) SMS service tests: mock Twilio, verify Premium tier gating, phone number validation, SMS content generation, opt-out handling 7) Scheduler tests: identify users needing weekly guides, batch processing logic, error handling and retries, skip delivered users 8) Q&A chatbot tests: Premium tier verification, rate limiting, question storage, context awareness 9) Use Jest or Mocha with Supertest for API testing 10) Mock external services (Stripe, OpenAI, email, SMS) 11) Test database with transactions rollback 12) Aim for 80%+ code coverage on critical paths.",
      "estimatedMinutes": 120
    },
    {
      "featureId": "feature-15",
      "name": "End-to-End User Journey Tests",
      "description": "E2E tests simulating complete user journeys from signup through onboarding, subscription, receiving guides, and using dashboard features. Validates the entire system works together correctly.",
      "agentAssigned": "e2e-tester",
      "dependencies": ["feature-10", "feature-11", "feature-12"],
      "files": [
        "tests/e2e/userJourney.spec.ts",
        "tests/e2e/subscription.spec.ts",
        "tests/e2e/premiumFeatures.spec.ts",
        "tests/e2e/setup.ts"
      ],
      "detailedPrompt": "Build E2E test scenarios using Playwright or Cypress: 1) Complete user signup journey: land on homepage → click pricing → select Basic tier → complete Stripe checkout (test mode) → create account → complete onboarding flow (due date, preferences, symptoms) → arrive at dashboard with profile created 2) Weekly guide delivery flow: user has profile → scheduler runs → guide generated → email sent → user views guide in dashboard 3) Premium subscription journey: Basic user on dashboard → sees upgrade prompt on Q&A feature → clicks upgrade → Stripe checkout to Premium → webhook updates subscription → Q&A chatbot unlocked → user asks question → receives AI answer 4) Profile update journey: user edits symptoms/preferences → saves changes → next weekly guide reflects updated personalization 5) Subscription management: user accesses Stripe customer portal → views subscription → cancels subscription → webhook updates status → access restricted 6) Mobile responsiveness tests across key pages 7) Use test Stripe keys and mock external APIs 8) Run tests in CI/CD pipeline 9) Screenshot comparison for UI regression 10) Performance testing: page load times, API response times under load.",
      "estimatedMinutes": 110
    }
  ]
}
